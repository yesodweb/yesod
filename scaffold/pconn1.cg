        connKeyValues <- (flip mapM) ["user", "password", "host", "port"] $ \key -> do
          value <- lookupScalar key settings
          return (T.pack key, value)
        return $ connKeyValues ++ [("dbname", database)]

    toConnStr :: [(Text, Text)] -> Text
    toConnStr = T.intercalate " " . map (\(k,v) -> T.concat [k,"=",v])

