    connKeyValues <- (flip mapM) ["user", "password", "host", "port"] $ \key -> do
      value <- lookupScalar key settings
      return (pack key, value)
    return $ connKeyValues ++ [("dbname", database)]

